#!/bin/sh

# Module showing RAM usage as a bar.

case $BLOCK_BUTTON in
    2) setsid -f "$TERMINAL" -e htop ;;
    3) notify-send "ðŸ“ˆ RAM usage module" "Single bar represents overall RAM usage.";;
    6) setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

# Get total and available RAM in KB
read total available < <(awk '/MemTotal/ {t=$2} /MemAvailable/ {a=$2} END {print t, a}' /proc/meminfo)

# Calculate used RAM percentage
used_percent=$(( (total - available) * 100 / total ))

# Display bar based on usage
case $((used_percent / 12)) in
    "0") printf "â–";;
    "1") printf "â–‚";;
    "2") printf "â–ƒ";;
    "3") printf "â–„";;
    "4") printf "â–…";;
    "5") printf "â–†";;
    "6") printf "â–‡";;
    "7") printf "â–ˆ";;
    "8") printf "â–ˆ";;
esac
printf "\\n"
